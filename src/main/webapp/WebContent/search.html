<%@ page contentType="text/html; charset=UTF-8"%>
<%@ taglib uri="http://java.sun.com/jsp/jstl/core" prefix="c"%>
<%@ taglib prefix="fmt" uri="http://java.sun.com/jsp/jstl/fmt"%>
<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Teamluck.gg</title>
<link rel="stylesheet" href="WebContent/search style.css">
<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Teamluck.gg</title>
	<link rel="stylesheet" href="search style.css">
</head>
<body>
	<!-- 헤더 영역 -->
	<header>
		<div class="logo">
			<a href="http://Teamluck.gg.com"><img
				src="../WebContent/lol-logo.png" alt="Teamluck.gg"></a>
			<a href="http://Teamluck.gg.com"><img src="lol-logo.png" alt="Teamluck.gg"></a>
		</div>

		<div class="navi">
			<nav>
				<ul>
					<li><a href="#">전적검색</a></li>
					<li><a href="#">커뮤니티</a></li>
					<li><a href="#">통합 인기글</a></li>
					<li><a href="#">로그아웃</a></li>
				</ul>
			</nav>
		</div>
	</header>
	<main>
		<div class="main section">

			<!-- 대문짝 -->
			<div class="main banner">
				<img
					src="https://opgg-static.akamaized.net/logo/20230414083144.6eb75aa6cdf74acba088a2c108e5a061.png?image=q_auto,f_webp,w_auto&amp;v=1681892839653"
					alt="Teamluck.gg">
			</div>
			<!-- 하단 영역 -->
			<div class="ADbanner">

	<!-- 메인 영역 -->
	<main>
		<div class="main section">
			
			<!-- 대문짝 -->
			<div class="main banner">
				<img src="https://i.ibb.co/fDR0YnX/teamluckgglogo2.png" alt="Teamluck.gg">
			</div>

			<!-- 하단 영역 -->
			<div class="ADbanner">

				<!-- 좌측 배너 -->
				<div class="ADbanner left">
					<img src="banner_left.png" alt="Banner Left">
				</div>

				<!-- 콘텐츠 영역 -->
				<div class="container">
					<h1>롤 전적 검색</h1>
					<form id="search-form">
						<label for="summoner-name">소환사명:</label> <input type="text"
							id="summoner-name" name="summoner-name">
						<button type="submit">검색</button>
					</form>
					<div id="summoner-info"></div>
					<div id="stats-container">
						<div class="summoner-stat-card">
							<h2>레벨 및 아이디</h2>
							<p class="stat-name">소환사명</p>
							<p class="stat-value" id="summoner-name-stat">${summoner.name}</p>
							<p class="stat-name">레벨</p>
							<p class="stat-value" id="summoner-level">${summoner.summonerLevel}</p>
							<p>Profile Icon ID: ${summoner.profileIconId}</p>
						</div>

						<div class="league-stat-card">
							<h2>현재 티어</h2>
							<c:forEach var="league" items="${leagues}">
								<p class="stat-name">솔로 랭크</p>
								<p class="stat-value" id="solo-tier">${league.queueType}</p>
								<p>tier: ${league.tier}</p>
								<p>rank: ${league.rank}</p>
								<p>leaguePoints: ${league.leaguePoints}</p>
								<p class="stat-name">승률</p>
								<p>wins: ${league.wins}</p>
								<p>losses: ${league.losses}</p>
								<p class="stat-value" id="solo-winrate"></p>
							</c:forEach>
						</div>
						<div class="match-stat-card">
							<h2>최근 전적</h2>
							<div id="match-history"></div>
							<h2>Match IDs</h2>
							<table>
								<tr>
									<th>Match ID</th>
									<th>Match Duration</th>
								</tr>
								<c:forEach var="matchId" items="${matchIds}">
									<c:set var="matchObject" value="${matchObjects[matchId]}" />
									<tr>
										<td>${matchId}</td>
										<c:set var="durationSeconds"
											value="${matchObject.get('info').getAsJsonObject().get('gameDuration').getAsLong()}" />
										<c:set var="minutes" value="${(durationSeconds / 60)}" />
										<c:set var="seconds" value="${(durationSeconds % 60)}" />
										<fmt:formatNumber value="${minutes}" pattern="00"
											var="formattedMinutes" />
										<fmt:formatNumber value="${seconds}" pattern="00"
											var="formattedSeconds" />
										<td>${formattedMinutes}:${formattedSeconds}</td>
									</tr>
									<tr>
										<td colspan="2" style="text-align: left;">Blue Team</td>
									</tr>
									<tr>
										<th>summonerName</th>
										<th>Champion Name</th>
										<th>summoner1Id</th>
										<th>summoner2Id</th>
										<th>Kill</th>
										<th>Death</th>
										<th>Assist</th>
									</tr>
									<c:set var="participantArray"
										value="${matchObject.get('info').getAsJsonObject().get('participants').getAsJsonArray()}" />
									<c:forEach begin="0" end="${participantArray.size() - 6}"
										varStatus="loop">
										<c:set var="participant"
											value="${participantArray.get(loop.index)}" />
										<tr>
											<td>${participant.get("summonerName").getAsString()}</td>
											<td>${participant.get("championName").getAsString()}</td>
											<td>${participant.get("summoner1Id").getAsInt()}</td>
											<td>${participant.get("summoner2Id").getAsInt()}</td>
											<td>${participant.get("kills").getAsInt()}</td>
											<td>${participant.get("deaths").getAsInt()}</td>
											<td>${participant.get("assists").getAsInt()}</td>
										</tr>
									</c:forEach>
									<tr>
										<td colspan="2" style="text-align: left;">Red Team</td>
									</tr>
									<tr>
										<th>summonerName</th>
										<th>Champion Name</th>
										<th>summoner1Id</th>
										<th>summoner2Id</th>
										<th>Kill</th>
										<th>Death</th>
										<th>Assist</th>
									</tr>
									<c:set var="participantArray"
										value="${matchObject.get('info').getAsJsonObject().get('participants').getAsJsonArray()}" />
									<c:forEach begin="5" end="${participantArray.size() - 1}"
										varStatus="loop">
										<c:set var="participant"
											value="${participantArray.get(loop.index)}" />
										<tr>
											<td>${participant.get("summonerName").getAsString()}</td>
											<td>${participant.get("championName").getAsString()}</td>
											<td>${participant.get("summoner1Id").getAsInt()}</td>
											<td>${participant.get("summoner2Id").getAsInt()}</td>
											<td>${participant.get("kills").getAsInt()}</td>
											<td>${participant.get("deaths").getAsInt()}</td>
											<td>${participant.get("assists").getAsInt()}</td>
										</tr>
									</c:forEach>
								</c:forEach>
							</table>
						</div>
						<div class="stat-card">
							<h2>모스트 챔피언별 승률 및 KDA</h2>
							<c:forEach var="entry" items="${mostPlayedChampions}">
								<c:set var="championName" value="${entry.key}" />
								<c:set var="playCount" value="${entry.value}" />
								<c:set var="winRate" value="${winRates[championName]}" />
								<p>Champion Name: ${championName}</p>
								<p>Count: ${playCount}</p>
								<p>Win Rate: ${winRate}%</p>
							</c:forEach>
							<div id="champion-stats"></div>
						</div>
					</div>
				</div>
				<script src="app.js"></script>
                <div class="container">
                    <h1>롤 전적 검색</h1>
                    <form id="search-form">
                        <label for="summoner-name">소환사명:</label>
                        <input type="text" id="summoner-name" name="summoner-name">
                        <button type="submit">검색</button>
                    </form>
                    <div id="summoner-info"></div>
		            <div id="stats-container">
			            <div class="stat-card">
				            <h2>레벨 및 아이디</h2>
				            <p class="stat-name">소환사명</p>
				            <p class="stat-value" id="summoner-name-stat"></p>
				            <p class="stat-name">레벨</p>
				            <p class="stat-value" id="summoner-level"></p>
			            </div>
			             <div class="stat-card">
				            <h2>현재 티어</h2>
				            <p class="stat-name">솔로 랭크</p>
				            <p class="stat-value" id="solo-tier"></p>
				            <p class="stat-name">승률</p>
				            <p class="stat-value" id="solo-winrate"></p>
			            </div>
                        <div class="stat-card">
				            <h2>최근 승률</h2>
				            <div id="recent-winrate"></div>
			            </div>
			             <div class="stat-card">
				            <h2>최근 전적</h2>
				            <div id="match-history"></div>
			            </div>
                        <div class="stat-card">
				            <h2>챔피언별 승률 및 KDA</h2>
				            <div id="champion-stats"></div>
			            </div>
		            </div>  
                </div>
                <script src="app.js"></script>

				<div class="ADbanner right">
					<img src="banner_right.png" alt="Banner Right">
				</div>
			</div>
		</div>
	</main>
</body>
</html>


</html>
